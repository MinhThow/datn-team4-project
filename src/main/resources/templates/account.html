<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Male-Fashion |Account Center</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

	<link rel="stylesheet" href="/css/account.css" type="text/css">
</head>

<body class="d-flex flex-column min-vh-100">
	<main class="flex-grow-1">
		<div class="container-fluid">
			<nav class="navbar navbar-expand-lg bg-white border-bottom shadow-sm">
				<div class="container d-flex justify-content-between align-items-center position-relative">


					<!-- Logo + Home cùng bên trái -->
					<div class="d-flex align-items-center">
						<a class="navbar-brand d-flex align-items-center me-3" href="/">
							<img src="/img/logo.png" alt="Logo" class="d-inline-block align-text-top me-2">
						</a>
						<a href="/" class="nav-link home-link text-dark fw-semibold">Home</a>
					</div>

					<!-- Tiêu đề ở giữa tuyệt đối -->
					<div class="position-absolute top-50 start-50 translate-middle">
						<span class="fw-bold fs-5 text-dark">Account Center</span>
					</div>

					<div>
						<a href="/logout" class="nav-link home-link text-dark fw-semibold d-flex align-items-center">
							<i class="bi bi-box-arrow-right me-1"></i> Log out
						</a>
					</div>
				</div>
			</nav>
		</div>
		<!-- Big TABS -->
		<div class="container mt-4">
			<div class="row gx-0">
				<!-- Tab Lớn (Vertical Nav) -->
				<div class="col-md-3 pe-2">
					<div class="nav flex-column nav-pills custom-vertical-tab" id="v-pills-tab" role="tablist"
						aria-orientation="vertical">
						<button class="nav-link active" id="v-pills-security-tab" data-bs-toggle="pill"
							data-bs-target="#v-pills-security" type="button" role="tab">Security</button>
						<button class="nav-link" id="v-pills-order-tab" data-bs-toggle="pill"
							data-bs-target="#v-pills-order" type="button" role="tab">Order</button>
						<button class="nav-link" id="v-pills-notify-tab" data-bs-toggle="pill"
							data-bs-target="#v-pills-notify" type="button" role="tab">Notification</button>
					</div>
				</div>

				<!-- Nội dung tab lớn -->
				<div class="col-md-6 ps-2">
					<div class="tab-content" id="v-pills-tabContent">
						<!-- SECURITY -->
						<div class="tab-pane fade show active" id="v-pills-security" role="tabpanel">
							<!-- Tabs nhỏ bên trong  -->
							<ul class="nav custom-underline-nav" id="myTab" role="tablist">
								<li class="nav-item" role="presentation">
									<button class="nav-link active" id="account-tab" data-bs-toggle="tab"
										data-bs-target="#account-tab-pane" type="button" role="tab"
										aria-controls="account-tab-pane" aria-selected="true">Account
										Details</button>
								</li>
								<li class="nav-item" role="presentation">
									<button class="nav-link" id="password-tab" data-bs-toggle="tab"
										data-bs-target="#password-tab-pane" type="button" role="tab"
										aria-controls="password-tab-pane" aria-selected="false">Password</button>
								</li>
								<li class="nav-item" role="presentation">
									<button class="nav-link" id="bank-tab" data-bs-toggle="tab"
										data-bs-target="#bank-tab-pane" type="button" role="tab"
										aria-controls="bank-tab-pane" aria-selected="false">Bank Account</button>
								</li>
								<li class="nav-item" role="presentation">
									<button class="nav-link" id="delete-tab" data-bs-toggle="tab"
										data-bs-target="#delete-tab-pane" type="button" role="tab"
										aria-controls="delete-tab-pane" aria-selected="false">Delete Account</button>
								</li>
							</ul>

							<div class="tab-content" id="myTabContent" style="min-height: 600px;">
								<div class="tab-pane fade show active" id="account-tab-pane" role="tabpanel"
									aria-labelledby="account-tab" tabindex="0">
									<!-- Nội dung Account Details ở đây -->
									<div class="w-75 mt-4">
										<form id="accountForm" th:action="@{/account}" th:object="${user}"
											method="post">



											<div class="mb-3">
												<label for="userID" class="form-label">User ID</label>
												<input type="text" class="form-control" id="userID" th:value="*{userID}"
													disabled>
												<input type="hidden" th:field="*{userID}" />
											</div>

											<div class="mb-3">
												<label for="name" class="form-label">Name</label>
												<input type="text" class="form-control" id="name" th:field="*{name}">
											</div>

											<div class="mb-3">
												<label for="email" class="form-label">Email</label>
												<input type="email" class="form-control" id="email" th:field="*{email}"
													disabled>
											</div>

											<div class="mb-3">
												<label for="phone" class="form-label">Phone</label>
												<input type="text" class="form-control" id="phone" th:field="*{phone}">
											</div>

											<div class="mb-3">
												<label for="address" class="form-label">Address</label>
												<input type="text" class="form-control" id="address"
													th:field="*{address}">
											</div>

											<div class="mb-3">
												<label for="createdAt" class="form-label">Created At</label>
												<input type="text" class="form-control" id="createdAt"
													th:value="${user.createdAt}" disabled>
											</div>

											<div class="text-center">
												<button type="submit" class="btn btn-danger">Update</button>
											</div>
										</form>
									</div>

								</div>
								<div class="tab-pane fade" id="password-tab-pane" role="tabpanel"
									aria-labelledby="password-tab" tabindex="0">
									<!-- Nội dung Password ở đây -->
									<div class="w-75 mt-4">
										<form th:action="@{/account/change-password}" method="post">
											<div class="mb-3">
												<label for="currentPassword" class="form-label">Current Password</label>
												<div class="input-group">
													<input type="password" class="form-control" id="currentPassword"
														name="currentPassword" required>
													<button type="button"
														class="btn btn-outline-secondary toggle-password"
														data-target="currentPassword"><i class="bi bi-eye"></i></button>
												</div>
											</div>

											<div class="mb-3">
												<label for="newPassword" class="form-label">New Password</label>
												<div class="input-group">
													<input type="password" class="form-control" id="newPassword"
														name="newPassword" required>
													<button type="button"
														class="btn btn-outline-secondary toggle-password"
														data-target="newPassword"><i class="bi bi-eye"></i></button>
												</div>
											</div>
											<div class="mb-3">
												<label for="confirmPassword" class="form-label">Confirm New
													Password</label>
												<div class="input-group">
													<input type="password" class="form-control" id="confirmPassword"
														name="confirmPassword" required>
													<button type="button"
														class="btn btn-outline-secondary toggle-password"
														data-target="confirmPassword"><i class="bi bi-eye"></i></button>
												</div>
												<div id="passwordError" class="text-danger mt-1" style="display: none;">
													Passwords do not
													match.
												</div>
											</div>
											<div class="text-center">
												<button type="submit" class="btn btn-danger">Change Password</button>
											</div>
										</form>
									</div>

								</div>
								<!-- BANK ACCOUNT TAB -->
								<div class="tab-pane fade" id="bank-tab-pane" role="tabpanel" aria-labelledby="bank-tab"
									tabindex="0">
									<div class="mt-4">
										<div class="container mt-4">
											<div class="d-flex justify-content-between align-items-center mb-3">
												<h5 class="mb-0">My Bank Accounts</h5>
												<button class="btn btn-primary" data-bs-toggle="modal"
													data-bs-target="#addBankModal">+ Add New</button>
											</div>

											<!-- Bank Accounts Loop -->
											<div th:if="${bankAccounts != null}">
												<div th:each="account : ${bankAccounts}"
													class="card shadow-sm w-75 mb-3">
													<div class="card-body">
														<div class="d-flex justify-content-between">
															<!-- Bank Info -->
															<div>
																<h6 class="card-title mb-2"
																	th:text="${account.bankName}">Vietcombank</h6>
																<p class="mb-1"><strong>Account Number:</strong> <span
																		th:text="${account.accountNumber}">0123456789</span>
																</p>
																<p class="mb-1"><strong>Account Holder:</strong> <span
																		th:text="${account.accountHolder}">Nguyen Van
																		A</span></p>
																<p class="mb-1"><strong>Branch:</strong> <span
																		th:text="${account.branch}">Ha Noi</span></p>
																<p class="mb-1"><strong>Card Type:</strong>
																	<span class="badge text-dark"
																		th:classappend="${account.cardType == 'Credit'} ? 'bg-warning' : 'bg-info'"
																		th:text="${account.cardType}">Debit</span>
																</p>
															</div>

															<!-- Action Buttons -->
															<div
																class="d-flex flex-column justify-content-center align-items-end">
																<button class="btn btn-sm btn-outline-danger"
																	type="button"
																	th:attr="onclick=|showDeleteModal(${account.id})|">
																	Delete
																</button>
															</div>

														</div>
													</div>
												</div>
											</div>

											<!-- No account -->
											<div th:if="${#lists.isEmpty(bankAccounts)}" class="alert alert-info w-75">
												You have no linked bank accounts.
											</div>
										</div>
									</div>
								</div>


								<!-- DELETE ACCOUNT TAB -->
								<div class="tab-pane fade" id="delete-tab-pane" role="tabpanel"
									aria-labelledby="delete-tab" tabindex="0">
									<div class="mt-4">
										<!-- Initial Section -->
										<div id="deleteAccountSection">
											<h4>Delete Account Request</h4>
											<button class="btn btn-warning mt-2" id="deleteBtn">Delete Account</button>
										</div>

										<!-- Confirmation Section -->
										<div id="confirmSection" class="d-none">
											<p class="fw-semibold">Clicking "Proceed" means you agree to the following
												terms:</p>
											<ul>
												<li>You will no longer be able to access this account.</li>
												<li>All personal data and related information will be permanently
													deleted.</li>
												<li>This action is irreversible.</li>
												<li>Any pending orders will be canceled.</li>
											</ul>
											<button class="btn btn-danger" id="proceedBtn">Proceed</button>
										</div>
									</div>
								</div>
							</div>
						</div>

						<!-- ORDER -->
						<div class="tab-pane fade" id="v-pills-order" role="tabpanel">
							<ul class="nav custom-underline-nav mt-3" role="tablist">
								<li class="nav-item" role="presentation">
									<button class="nav-link active" id="all-tab" data-bs-toggle="tab"
										data-bs-target="#all-pane" type="button" role="tab">All</button>
								</li>
								<li class="nav-item" role="presentation">
									<button class="nav-link" id="delivering-tab" data-bs-toggle="tab"
										data-bs-target="#delivering-pane" type="button" role="tab">Being
										Delivered</button>
								</li>
								<li class="nav-item" role="presentation">
									<button class="nav-link" id="completed-tab" data-bs-toggle="tab"
										data-bs-target="#completed-pane" type="button" role="tab">Completed</button>
								</li>
								<li class="nav-item" role="presentation">
									<button class="nav-link" id="canceled-tab" data-bs-toggle="tab"
										data-bs-target="#canceled-pane" type="button" role="tab">Canceled</button>
								</li>
							</ul>

							<div class="tab-content mt-3" style="min-height: 600px;">

								<!-- Tab All -->
								<div class="tab-pane fade show active" id="all-pane" role="tabpanel">
									<!-- ✅ Nếu KHÔNG có đơn hàng -->
									<div th:if="${#lists.isEmpty(allOrders)}" class="text-center text-muted mt-5">
										<i class="bi bi-bag-x" style="font-size: 2rem;"></i>
										<p class="mt-2">Không có đơn hàng nào.</p>
									</div>

									<!-- ✅ Nếu CÓ đơn hàng -->
									<div th:each="order : ${allOrders}" class="card shadow-sm mb-3">
										<div class="card-body">
											<!-- Tiêu đề đơn hàng -->
											<div class="d-flex justify-content-between align-items-start mb-2">
												<h6 class="mb-3">Order #[[${order.orderId}]]</h6>
												<span class="badge"
													th:classappend="${order.badgeColor}">[[${order.status}]]</span>
											</div>

											<!-- Thân card -->
											<div class="d-flex justify-content-between align-items-center">
												<!-- Bên trái: ảnh + thông tin sản phẩm -->
												<div class="d-flex">
													<div
														style="width: 80px; height: 80px; overflow: hidden; border: 1px solid #ddd; border-radius: 4px;">
														<img th:src="@{${order.imageUrl}}" alt="Product"
															class="img-fluid" />
													</div>
													<div class="ms-3">
														<p class="mb-1 fw-semibold">[[${order.productName}]]</p>
														<p class="mb-1 text-muted">Qty: [[${order.quantity}]]</p>
														<p class="mb-1 text-muted">Size: [[${order.size}]]</p>
													</div>
												</div>

												<!-- Bên phải: đơn giá và tổng -->
												<div
													class="text-end d-flex flex-column justify-content-center align-items-end">
													<p class="mb-1 text-muted">Đơn giá: $[[${order.price}]]</p>
													<p class="mb-0 fw-bold text-danger">Tổng: $[[${order.totalPrice}]]
													</p>
												</div>
											</div>

											<!-- Thông tin thêm -->
											<div class="mt-3">
												<p class="mb-1"><strong>Địa chỉ giao hàng:</strong>
													[[${order.shippingAddress}]]</p>
												<p class="mb-1"><strong>Ghi chú:</strong> [[${order.note}]]</p>
												<p class="mb-0"><strong>Phương thức thanh toán:</strong>
													[[${order.paymentMethodName}]]</p>
											</div>

											<!-- Nút hành động theo trạng thái -->
											<div class="mt-3 text-end">
												<button class="btn btn-sm btn-outline-primary"
													th:if="${order.status == 'Đang giao'}">Theo dõi</button>

												<div class="d-flex justify-content-end gap-2"
													th:if="${order.status == 'Đã giao'}">
													<button class="btn btn-sm btn-outline-secondary"
														data-bs-toggle="modal" data-bs-target="#reviewModal">Đánh
														giá</button>
													<button class="btn btn-sm btn-outline-success">Mua lại</button>
												</div>

												<button class="btn btn-sm btn-outline-secondary"
													th:if="${order.status == 'Đã hủy'}">Chi tiết</button>
											</div>
										</div>
									</div>
								</div>


								<!-- Tab Being Delivered -->
								<div class="tab-pane fade" id="delivering-pane" role="tabpanel">
									<div class="tab-pane fade show active" id="delivering-pane" role="tabpanel">

										<!-- Hiển thị khi không có đơn -->
										<div th:if="${#lists.isEmpty(deliveringOrders)}"
											class="text-center text-muted mt-5">
											<i class="bi bi-truck"></i>
											<p class="mt-2">Không có đơn hàng đang vận chuyển.</p>
										</div>

										<!-- Hiển thị đơn hàng -->
										<div th:each="order : ${deliveringOrders}" class="card shadow-sm mb-3">
											<div class="card-body">

												<!-- Header -->
												<div class="d-flex justify-content-between align-items-start mb-2">
													<h6 class="mb-3">Order #[[${order.orderId}]]</h6>
													<span class="badge bg-primary">Đang giao</span>
												</div>

												<!-- Thân card: ảnh + info + giá -->
												<div class="d-flex justify-content-between align-items-center">
													<!-- Bên trái: ảnh + thông tin -->
													<div class="d-flex">
														<div
															style="width: 80px; height: 80px; overflow: hidden; border: 1px solid #ddd; border-radius: 4px;">
															<img th:src="@{${order.imageUrl}}" alt="Product"
																class="img-fluid" />
														</div>
														<div class="ms-3">
															<p class="mb-1 fw-semibold">[[${order.productName}]]</p>
															<p class="mb-1 text-muted">Qty: [[${order.quantity}]]</p>
															<p class="mb-1 text-muted">Size: [[${order.size}]]</p>
														</div>
													</div>

													<!-- Bên phải: đơn giá + tổng -->
													<div
														class="text-end d-flex flex-column justify-content-center align-items-end">
														<p class="mb-1 text-muted">Đơn giá: $[[${order.price}]]</p>
														<p class="mb-0 fw-bold text-danger">Tổng:
															$[[${order.totalPrice}]]</p>
													</div>
												</div>

												<!-- Thông tin thêm -->
												<div class="mt-3">
													<p class="mb-1"><strong>Địa chỉ giao hàng:</strong>
														[[${order.shippingAddress}]]</p>
													<p class="mb-1"><strong>Ghi chú:</strong> [[${order.note}]]</p>
													<p class="mb-0"><strong>Phương thức thanh toán:</strong>
														[[${order.paymentMethodName}]]</p>
												</div>

												<!-- Nút hành động -->
												<div class="mt-3 text-end">
													<button class="btn btn-sm btn-outline-primary">Theo dõi</button>
												</div>

											</div>
										</div>

									</div>
								</div>



								<!-- Tab Completed -->
								<div class="tab-pane fade" id="completed-pane" role="tabpanel">

									<!-- Nếu không có đơn -->
									<div th:if="${#lists.isEmpty(completedOrders)}" class="text-center text-muted mt-5">
										<i class="bi bi-check-circle"></i>
										<p class="mt-2">Không có đơn hàng đã hoàn thành.</p>
									</div>

									<!-- Nếu có đơn -->
									<div th:each="order : ${completedOrders}" class="card shadow-sm mb-3">
										<div class="card-body">
											<!-- Header -->
											<div class="d-flex justify-content-between align-items-start mb-2">
												<h6 class="mb-3">Order #[[${order.orderId}]]</h6>
												<span class="badge bg-success">Đã giao</span>
											</div>

											<!-- Thân card -->
											<div class="d-flex justify-content-between align-items-center">
												<!-- Trái: ảnh + info -->
												<div class="d-flex">
													<div
														style="width: 80px; height: 80px; overflow: hidden; border: 1px solid #ddd; border-radius: 4px;">
														<img th:src="@{${order.imageUrl}}" alt="Product"
															class="img-fluid" />
													</div>
													<div class="ms-3">
														<p class="mb-1 fw-semibold">[[${order.productName}]]</p>
														<p class="mb-1 text-muted">Qty: [[${order.quantity}]]</p>
														<p class="mb-1 text-muted">Size: [[${order.size}]]</p>
													</div>
												</div>

												<!-- Phải: giá -->
												<div
													class="text-end d-flex flex-column justify-content-center align-items-end">
													<p class="mb-1 text-muted">Đơn giá: $[[${order.price}]]</p>
													<p class="mb-0 fw-bold text-danger">Tổng: $[[${order.totalPrice}]]
													</p>
												</div>
											</div>

											<!-- Thông tin thêm -->
											<div class="mt-3">
												<p class="mb-1"><strong>Địa chỉ giao hàng:</strong>
													[[${order.shippingAddress}]]</p>
												<p class="mb-1"><strong>Ghi chú:</strong> [[${order.note}]]</p>
												<p class="mb-0"><strong>Phương thức thanh toán:</strong>
													[[${order.paymentMethodName}]]</p>
											</div>

											<!-- Nút hành động -->
											<div class="mt-3 text-end">
												<div class="d-flex justify-content-end gap-2">
													<button class="btn btn-sm btn-outline-secondary"
														data-bs-toggle="modal" data-bs-target="#reviewModal">Đánh
														giá</button>
													<button class="btn btn-sm btn-outline-success">Mua lại</button>
												</div>
											</div>
										</div>
									</div>
								</div>



								<!-- Tab Canceled -->
								<div class="tab-pane fade" id="canceled-pane" role="tabpanel">

									<!-- Khi không có đơn -->
									<div th:if="${#lists.isEmpty(canceledOrders)}" class="text-center text-muted mt-5">
										<i class="bi bi-x-circle"></i>
										<p class="mt-2">Không có đơn hàng bị hủy.</p>
									</div>

									<!-- Khi có đơn -->
									<div th:each="order : ${canceledOrders}" class="card shadow-sm mb-3">
										<div class="card-body">
											<!-- Tiêu đề đơn hàng -->
											<div class="d-flex justify-content-between align-items-start mb-2">
												<h6 class="mb-3">Order #[[${order.orderId}]]</h6>
												<span class="badge bg-secondary">Đã hủy</span>
											</div>

											<!-- Thân card -->
											<div class="d-flex justify-content-between align-items-center">
												<!-- Bên trái: ảnh + thông tin sản phẩm -->
												<div class="d-flex">
													<div
														style="width: 80px; height: 80px; overflow: hidden; border: 1px solid #ddd; border-radius: 4px;">
														<img th:src="@{${order.imageUrl}}" alt="Product"
															class="img-fluid" />
													</div>
													<div class="ms-3">
														<p class="mb-1 fw-semibold">[[${order.productName}]]</p>
														<p class="mb-1 text-muted">Qty: [[${order.quantity}]]</p>
														<p class="mb-1 text-muted">Size: [[${order.size}]]</p>
													</div>
												</div>

												<!-- Bên phải: đơn giá và tổng -->
												<div
													class="text-end d-flex flex-column justify-content-center align-items-end">
													<p class="mb-1 text-muted">Đơn giá: $[[${order.price}]]</p>
													<p class="mb-0 fw-bold text-danger">Tổng: $[[${order.totalPrice}]]
													</p>
												</div>
											</div>

											<!-- Thông tin thêm -->
											<div class="mt-3">
												<p class="mb-1"><strong>Địa chỉ giao hàng:</strong>
													[[${order.shippingAddress}]]</p>
												<p class="mb-1"><strong>Ghi chú:</strong> [[${order.note}]]</p>
												<p class="mb-0"><strong>Phương thức thanh toán:</strong>
													[[${order.paymentMethodName}]]</p>
											</div>

											<!-- Nút hành động -->
											<div class="mt-3 text-end">
												<button class="btn btn-sm btn-outline-secondary">Chi tiết</button>
											</div>
										</div>
									</div>
								</div>


							</div>
						</div>



						<!-- NOTIFICATION -->
						<div class="tab-pane fade" id="v-pills-notify" role="tabpanel">
							<ul class="nav custom-underline-nav mt-3" role="tablist">
								<li class="nav-item" role="presentation">
									<button class="nav-link active" id="noti-setting-tab" data-bs-toggle="tab"
										data-bs-target="#noti-setting-pane" type="button" role="tab">Setting</button>
								</li>
								<li class="nav-item" role="presentation">
									<button class="nav-link" id="noti-news-tab" data-bs-toggle="tab"
										data-bs-target="#noti-news-pane" type="button" role="tab">News</button>
								</li>
							</ul>

							<div class="tab-content mt-3" style="min-height: 600px;">
								<div class="tab-pane fade show active" id="noti-setting-pane" role="tabpanel">
									<div class="container py-4">
										<!-- Notification Section Template -->
										<div class="mb-4">
											<div class="d-flex justify-content-between align-items-center bg-light px-3 py-2 rounded toggle-header"
												data-bs-target="#emailOptions" aria-expanded="true">
												<div>
													<strong>Email Notifications</strong>
													<p class="text-muted small mb-0">Important alerts cannot be disabled
													</p>
												</div>
												<div class="form-check form-switch">
													<input class="form-check-input main-toggle" type="checkbox" checked
														data-target="#emailOptions">
												</div>
											</div>
											<div class="collapse show mt-2 ms-3" id="emailOptions">
												<div class="form-check">
													<input class="form-check-input" type="checkbox" checked
														id="orderUpdatesEmail">
													<label class="form-check-label" for="orderUpdatesEmail">Order
														Updates</label>
												</div>
												<div class="form-check">
													<input class="form-check-input" type="checkbox" checked
														id="promoEmail">
													<label class="form-check-label" for="promoEmail">Promotions</label>
												</div>
												<div class="form-check">
													<input class="form-check-input" type="checkbox" checked
														id="surveyEmail">
													<label class="form-check-label" for="surveyEmail">Surveys</label>
												</div>
											</div>
										</div>

										<!-- SMS Notifications -->
										<div class="mb-4">
											<div class="d-flex justify-content-between align-items-center bg-light px-3 py-2 rounded toggle-header"
												data-bs-target="#smsOptions" aria-expanded="true">
												<div>
													<strong>SMS Notifications</strong>
													<p class="text-muted small mb-0">Important alerts cannot be disabled
													</p>
												</div>
												<div class="form-check form-switch">
													<input class="form-check-input main-toggle" type="checkbox" checked
														data-target="#smsOptions">
												</div>
											</div>
											<div class="collapse show mt-2 ms-3" id="smsOptions">
												<div class="form-check">
													<input class="form-check-input" type="checkbox" checked
														id="promoSMS">
													<label class="form-check-label" for="promoSMS">Promotions</label>
												</div>
											</div>
										</div>

										<!-- Zalo Notifications -->
										<div class="mb-4">
											<div class="d-flex justify-content-between align-items-center bg-light px-3 py-2 rounded toggle-header"
												data-bs-target="#zaloOptions" aria-expanded="true">
												<div>
													<strong>Zalo Notifications</strong>
													<p class="text-muted small mb-0">Important alerts cannot be disabled
													</p>
												</div>
												<div class="form-check form-switch">
													<input class="form-check-input main-toggle" type="checkbox" checked
														data-target="#zaloOptions">
												</div>
											</div>
											<div class="collapse show mt-2 ms-3" id="zaloOptions">
												<div class="form-check">
													<input class="form-check-input" type="checkbox" checked
														id="promoZalo">
													<label class="form-check-label" for="promoZalo">Promotions</label>
												</div>
											</div>
										</div>
									</div>

								</div>
								<div class="tab-pane fade" id="noti-news-pane" role="tabpanel">
									<h5 class="mb-3">Latest News & Notifications</h5>

									<!-- News Item -->
									<div class="card shadow-sm mb-3 border-start border-primary border-4">
										<div class="card-body">
											<div class="d-flex justify-content-between">
												<div>
													<h6 class="fw-bold mb-1">
														<i class="bi bi-megaphone-fill text-primary me-1"></i> Summer
														Sale is Live!
													</h6>
													<p class="mb-1 text-muted">Enjoy up to 50% off on selected items
														until August 31st.</p>
													<a href="#" class="text-decoration-none">View details</a>
												</div>
												<small class="text-muted">3 hours ago</small>
											</div>
										</div>
									</div>

									<!-- News Item -->
									<div class="card shadow-sm mb-3 border-start border-success border-4">
										<div class="card-body">
											<div class="d-flex justify-content-between">
												<div>
													<h6 class="fw-bold mb-1">
														<i class="bi bi-box-seam text-success me-1"></i> New Shipping
														Policy
													</h6>
													<p class="mb-1 text-muted">We’ve updated our shipping terms to offer
														faster delivery.</p>
													<a href="#" class="text-decoration-none">Learn more</a>
												</div>
												<small class="text-muted">1 day ago</small>
											</div>
										</div>
									</div>

									<!-- News Item -->
									<div class="card shadow-sm mb-3 border-start border-danger border-4">
										<div class="card-body">
											<div class="d-flex justify-content-between">
												<div>
													<h6 class="fw-bold mb-1">
														<i class="bi bi-exclamation-circle-fill text-danger me-1"></i>
														System Maintenance
													</h6>
													<p class="mb-1 text-muted">We’ll be undergoing scheduled maintenance
														on August 1 from 1:00–3:00 AM.</p>
													<a href="#" class="text-decoration-none">Check schedule</a>
												</div>
												<small class="text-muted">2 days ago</small>
											</div>
										</div>
									</div>
								</div>

							</div>
						</div>


					</div>
				</div>
				<div class="col-md-3 ps-2">
					<!-- Security Overview -->
					<div class="card border shadow-sm p-3">
						<h5 class="mb-3"><i class="bi bi-shield-lock-fill text-danger"></i> Security Overview</h5>
						<ul class="list-group list-group-flush small">
							<li class="list-group-item d-flex justify-content-between">
								<span>Phone</span>
								<span class="badge bg-success">Verified</span>
							</li>
							<li class="list-group-item d-flex justify-content-between">
								<span>Email</span>
								<span th:if="${userVerified}" class="badge bg-success">Verified</span>
								<span th:if="${!userVerified}" class="badge bg-warning text-dark">Not Verified</span>

							</li>
							<li class="list-group-item d-flex justify-content-between">
								<span>Password age</span>
								<span class="badge bg-info text-dark" th:text="${passwordAge} + ' days'">50 days</span>
							</li>

						</ul>
						<div class="mt-3 text-end">
							<a href="#" class="btn btn-outline-secondary btn-sm disabled">Email Verified</a>

							<a th:if="${!userVerified}" href="#" class="btn btn-outline-secondary btn-sm"
								data-bs-toggle="modal" data-bs-target="#verifyEmailModal">Verify Email</a>
						</div>

					</div>

					<!-- LOGIN HISTORY -->
					<div class="card border shadow-sm p-3 mt-4 mb-4">
						<h5 class="mb-3">
							<i class="bi bi-clock-history text-primary"></i> Login History
						</h5>

						<ul class="list-group list-group-flush small" id="login-history-list">
							<li class="list-group-item" th:each="login, iterStat : ${loginHistory}"
								th:classappend="${iterStat.index >= 2} ? 'd-none login-item-extra' : ''">
								<strong th:text="${login.time}"></strong><br />
								<span th:text="'IP: ' + ${login.ip}"></span><br />
								<span th:text="${login.userAgent}"></span>
							</li>
						</ul>

						<nav class="mt-2 d-none" id="login-pagination-container">
							<ul class="pagination justify-content-end pagination-sm" id="login-pagination">
								<!-- Pagination sẽ được tạo bằng JS -->
							</ul>
						</nav>

						<div class="mt-2 text-end">
							<button class="btn btn-sm btn-outline-secondary" id="toggle-login-history"
								onclick="toggleLoginHistory()">Expand</button>
						</div>
					</div>




				</div>
			</div>
		</div>
	</main>





	<!-- Footer Section Begin -->
	<footer class="bg-dark text-white pt-5 pb-4 mt-auto">
		<div class="container">
			<div class="row">
				<!-- Logo + About -->
				<div class="col-lg-3 col-md-6 col-sm-6 mb-4">
					<div class="mb-3">
						<a href="#"><img src="img/footer-logo.png" alt="Logo"></a>
					</div>
					<p>The customer is at the heart of our unique business model, which includes design.</p>
					<div class="mt-3">
						<a href="#"><img src="img/payment.png" alt="Payments"></a>
					</div>
				</div>

				<!-- Shopping Column 1 -->
				<div class="col-lg-2 offset-lg-1 col-md-3 col-sm-6 mb-4">
					<h6 class="text-uppercase fw-bold">Shopping</h6>
					<ul class="list-unstyled mt-3">
						<li><a href="#" class="text-light text-decoration-none d-block mb-1">Clothing Store</a></li>
						<li><a href="#" class="text-light text-decoration-none d-block mb-1">Trending Shoes</a></li>
						<li><a href="#" class="text-light text-decoration-none d-block mb-1">Accessories</a></li>
						<li><a href="#" class="text-light text-decoration-none d-block mb-1">Sale</a></li>
					</ul>
				</div>

				<!-- Shopping Column 2 -->
				<div class="col-lg-2 col-md-3 col-sm-6 mb-4">
					<h6 class="text-uppercase fw-bold">Shopping</h6>
					<ul class="list-unstyled mt-3">
						<li><a href="#" class="text-light text-decoration-none d-block mb-1">Contact Us</a></li>
						<li><a href="#" class="text-light text-decoration-none d-block mb-1">Payment Methods</a></li>
						<li><a href="#" class="text-light text-decoration-none d-block mb-1">Delivery</a></li>
						<li><a href="#" class="text-light text-decoration-none d-block mb-1">Return & Exchanges</a></li>
					</ul>
				</div>

				<!-- Newsletter -->
				<div class="col-lg-3 offset-lg-1 col-md-6 col-sm-6 mb-4">
					<h6 class="text-uppercase fw-bold">Newsletter</h6>
					<p class="mt-3">Be the first to know about new arrivals, look books, sales & promos!</p>
					<form action="#" class="d-flex border-bottom border-light">
						<input type="text" class="form-control bg-dark border-0 text-white" placeholder="Your email"
							style="border-radius: 0;">
						<button type="submit" class="btn text-white"><i class="bi bi-envelope"></i></button>
					</form>
				</div>
			</div>

			<!-- Copyright -->
			<div class="row mt-4 pt-3 border-top border-secondary">
				<div class="col-12 text-center">
					<p class="mb-0 small">
						Copyright ©
						<script>document.write(new Date().getFullYear());</script>2020
						All rights reserved | This template is made with
						<i class="bi bi-heart text-danger"></i> by
						<a href="https://colorlib.com" target="_blank"
							class="text-danger text-decoration-none">Colorlib</a>
					</p>
				</div>
			</div>
		</div>
	</footer>
	<!-- Footer Section End -->


	<!-- Modal Section -->
	<!-- Modal success -->
	<div class="modal fade" id="successModal" tabindex="-1">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header bg-success text-white">
					<h5 class="modal-title">Thành công</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<p th:text="${success}">Thao tác thành công!</p>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal error -->
	<div class="modal fade" id="errorModal" tabindex="-1">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header bg-danger text-white">
					<h5 class="modal-title">Lỗi</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<p th:text="${error}">Có lỗi xảy ra</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Add Bank Modal -->
	<div class="modal fade" id="addBankModal" tabindex="-1" aria-labelledby="addBankModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<form th:action="@{/api/bank-accounts}" method="post" th:object="${newBankAccount}">
					<!-- same fields as cũ nhưng phải có `name` và `th:field` -->
					<div class="modal-body">
						<div class="mb-3">
							<label for="bankName" class="form-label">Bank Name</label>
							<select class="form-select" th:field="*{bankName}" required>
								<option value="">Choose bank</option>
								<option value="Vietcombank">Vietcombank</option>
								<option value="Techcombank">Techcombank</option>
								<option value="ACB">ACB</option>
								<option value="TPBank">TPBank</option>
								<option value="BIDV">BIDV</option>
							</select>
						</div>
						<div class="mb-3">
							<label class="form-label">Account Number</label>
							<input type="text" class="form-control" th:field="*{accountNumber}" required>
						</div>
						<div class="mb-3">
							<label class="form-label">Account Holder</label>
							<input type="text" class="form-control" th:field="*{accountHolder}" required>
						</div>
						<div class="mb-3">
							<label class="form-label">Branch</label>
							<input type="text" class="form-control" th:field="*{branch}">
						</div>
						<div class="mb-3">
							<label class="form-label">Card Type</label>
							<select class="form-select" th:field="*{cardType}" required>
								<option value="">Choose type</option>
								<option value="Debit">Debit</option>
								<option value="Credit">Credit</option>
							</select>
						</div>
						<div class="row">
							<div class="col-md-6 mb-3">
								<label class="form-label">CVV</label>
								<input type="text" class="form-control" th:field="*{cvv}" maxlength="4" required>
							</div>
							<div class="col-md-6 mb-3">
								<label class="form-label">Expiration Date</label>
								<input type="month" class="form-control" th:field="*{expiryDate}" required>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
						<button type="submit" class="btn btn-danger">Save</button>
					</div>
				</form>

			</div>
		</div>
	</div>
	<!-- Delete Bank Account -->
	<div class="modal fade" id="bankDeleteModal" tabindex="-1" aria-labelledby="bankDeleteLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header bg-danger text-white">
					<h5 class="modal-title" id="bankDeleteLabel">Confirm Bank Account Deletion</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<p>Are you sure you want to delete this bank account?</p>
				</div>
				<div class="modal-footer">
					<form id="bankDeleteForm" method="post">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
						<button type="submit" class="btn btn-danger">Yes, Delete</button>
					</form>
				</div>
			</div>
		</div>
	</div>

	<!-- Delete Account Modal -->
	<div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-labelledby="confirmDeleteModalLabel"
		aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content border-danger">
				<div class="modal-header bg-danger text-white">
					<h5 class="modal-title" id="confirmDeleteModalLabel">Final Confirmation</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
						aria-label="Close"></button>
				</div>
				<div class="modal-body text-center">
					<p class="fw-bold text-danger fs-5">Are you sure you want to delete your account?</p>
					<p>This action cannot be undone.</p>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-danger" id="finalDeleteBtn">Yes, Delete</button>
				</div>
			</div>
		</div>
	</div>
	<!-- Verify Email Modal -->
	<div class="modal fade" id="verifyEmailModal" tabindex="-1" aria-labelledby="verifyEmailModalLabel"
		aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">

				<div class="modal-header bg-warning">
					<h5 class="modal-title" id="verifyEmailModalLabel"><i class="bi bi-envelope-exclamation-fill"></i>
						Verify Your Email</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>

				<div class="modal-body">
					<p>
						We will send a verification link to your registered email address.
						Please check your inbox and follow the instructions to verify.
					</p>
				</div>

				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button id="confirmVerifyEmailBtn" type="button" class="btn btn-warning">Send Verification
						Email</button>
				</div>

			</div>
		</div>
	</div>
	<!-- Review Modal -->
	<div class="modal fade" id="reviewModal" tabindex="-1" aria-labelledby="reviewModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered modal-lg">
			<div class="modal-content p-4">

				<div class="modal-header border-0">
					<h5 class="modal-title mx-auto fw-bold" id="reviewModalLabel">Đánh giá sản phẩm</h5>
				</div>

				<div class="modal-body">
					<!-- Hàng 1: Hình + Tên sản phẩm -->
					<div class="d-flex align-items-center mb-3">
						<img src="https://via.placeholder.com/80" alt="Product" class="rounded border me-3"
							style="width: 80px; height: 80px; object-fit: cover;">
						<h6 class="mb-0">Tên sản phẩm</h6>
					</div>

					<!-- Hàng 2: Tên người dùng -->
					<p class="mb-1"><strong>Người đánh giá:</strong> Tên người dùng</p>

					<!-- Hàng 3: 5 sao -->
					<div class="mb-3">
						<strong>Đánh giá:</strong>
						<div>
							<i class="bi bi-star text-warning fs-4"></i>
							<i class="bi bi-star text-warning fs-4"></i>
							<i class="bi bi-star text-warning fs-4"></i>
							<i class="bi bi-star text-warning fs-4"></i>
							<i class="bi bi-star text-secondary fs-4"></i>
						</div>
					</div>

					<!-- Hàng 4: Bình luận -->
					<div class="mb-3">
						<label class="form-label"><strong>Bình luận:</strong></label>
						<textarea class="form-control" rows="4" placeholder="Nhập nhận xét..."></textarea>
					</div>

					<!-- Hàng 5: Ngày đánh giá -->
					<p class="text-muted mb-0"><strong>Ngày đánh giá:</strong> 2025-07-28</p>
				</div>

				<!-- Footer -->
				<div class="modal-footer border-0 justify-content-center">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
					<button type="button" class="btn btn-primary" onclick="submitReview()">Gửi đánh giá</button>
				</div>

			</div>
		</div>
	</div>


	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
		crossorigin="anonymous"></script>
</body>
<script th:inline="javascript">
	/*<![CDATA[*/
	const hasSuccess = /*[[${success != null}]]*/ false;
	const hasError = /*[[${error != null}]]*/ false;

	if (hasSuccess) {
		const modal = new bootstrap.Modal(document.getElementById('successModal'));
		modal.show();
	}

	if (hasError) {
		const modal = new bootstrap.Modal(document.getElementById('errorModal'));
		modal.show();
	}
	/*]]>*/
</script>
<script>
	document.addEventListener('DOMContentLoaded', function () {
		const btn = document.getElementById('confirmVerifyEmailBtn');
		if (btn) {
			btn.addEventListener('click', function () {
				fetch('/verify-email', {method: 'POST'})
					.then(res => {
						if (res.ok) {
							alert("Email xác minh đã được gửi!");
							const modal = bootstrap.Modal.getInstance(document.getElementById("verifyEmailModal"));
							modal.hide();
						} else {
							alert("Gửi thất bại");
						}
					})
					.catch(error => {
						console.error("Lỗi khi gửi xác minh email:", error);
						alert("Lỗi hệ thống!");
					});
			});
		}
	});
</script>
<script>
	document.addEventListener("DOMContentLoaded", function () {
		const deleteBtn = document.getElementById("deleteBtn");
		const proceedBtn = document.getElementById("proceedBtn");
		const finalDeleteBtn = document.getElementById("finalDeleteBtn");

		if (deleteBtn) {
			deleteBtn.addEventListener("click", function () {
				document.getElementById("deleteAccountSection")?.classList.add("d-none");
				document.getElementById("confirmSection")?.classList.remove("d-none");
			});
		}

		if (proceedBtn) {
			proceedBtn.addEventListener("click", function () {
				const modal = new bootstrap.Modal(document.getElementById("confirmDeleteModal"));
				modal.show();
			});
		}

		if (finalDeleteBtn) {
			finalDeleteBtn.addEventListener("click", function () {
				fetch("/account/delete", {
					method: "POST"
				})
					.then(response => {
						if (response.redirected) {
							window.location.href = response.url;
						} else {
							alert("Không thể xoá tài khoản!");
						}
					})
					.catch(error => {
						console.error("Lỗi khi xoá:", error);
						alert("Đã có lỗi xảy ra!");
					});
			});
		}
	});
</script>
<script>
	document.addEventListener("DOMContentLoaded", function () {
		document.querySelectorAll(".main-toggle").forEach(toggle => {
			toggle.addEventListener("change", function () {
				const targetId = this.getAttribute("data-target");
				const target = document.querySelector(targetId);
				if (!target) return;

				const bsCollapse = bootstrap.Collapse.getOrCreateInstance(target);

				if (this.checked) {
					bsCollapse.show();
				} else {
					bsCollapse.hide();
				}
			});
		});
	});
</script>
<script>
	function showDeleteModal(id) {
		const form = document.getElementById("bankDeleteForm");
		if (form) {
			form.action = "/api/bank-accounts/delete/" + id;
		}

		const modalEl = document.getElementById("bankDeleteModal");
		if (modalEl) {
			const modal = new bootstrap.Modal(modalEl);
			modal.show();
		}
	}
</script>


<script>
	document.querySelectorAll('.toggle-password').forEach(button => {
		button.addEventListener('click', () => {
			const targetId = button.getAttribute('data-target');
			const input = document.getElementById(targetId);
			const icon = button.querySelector('i');

			if (input.type === 'password') {
				input.type = 'text';
				icon.classList.remove('bi-eye');
				icon.classList.add('bi-eye-slash');
			} else {
				input.type = 'password';
				icon.classList.remove('bi-eye-slash');
				icon.classList.add('bi-eye');
			}
		});
	});

	const passwordForm = document.getElementById('passwordForm');
	passwordForm.addEventListener('submit', function (event) {
		const newPassword = document.getElementById('newPassword').value;
		const confirmPassword = document.getElementById('confirmPassword').value;
		const errorDiv = document.getElementById('passwordError');

		if (newPassword !== confirmPassword) {
			event.preventDefault(); // Ngăn form submit
			errorDiv.style.display = 'block';
		} else {
			errorDiv.style.display = 'none'; // Ẩn lỗi nếu đúng
		}
	});

	function submitReview() {
		alert("Đánh giá đã được gửi!");
		const modal = bootstrap.Modal.getInstance(document.getElementById('reviewModal'));
		modal.hide();
	}
</script>
<script>
	let isExpanded = false;
	const perPage = 3;
	let currentPage = 1;
	let totalItems = 0;
	let items = [];

	document.addEventListener("DOMContentLoaded", function () {
		items = Array.from(document.querySelectorAll('#login-history-list li'));
		totalItems = items.length;

		if (totalItems > 2) {
			// Chỉ hiển thị 2 item đầu
			items.forEach((el, idx) => {
				el.classList.toggle("d-none", idx >= 2);
			});
		}

		// Ẩn pagination ban đầu
		document.getElementById('login-pagination-container').classList.add("d-none");
	});

	function toggleLoginHistory() {
		if (!isExpanded) {
			// Expand: hiện thêm dòng thứ 3
			if (totalItems >= 3) {
				items[2].classList.remove("d-none");
			}
			isExpanded = true;

			// Hiện pagination nếu đủ dữ liệu
			if (totalItems > 3) {
				document.getElementById('login-pagination-container').classList.remove("d-none");
				buildPagination();
				showPage(1);
			}

			// Đổi tên nút
			document.getElementById("toggle-login-history").innerText = "Collapse";
		} else {
			// Collapse: trở về chỉ hiện 2 dòng đầu
			items.forEach((el, idx) => {
				el.classList.toggle("d-none", idx >= 2);
			});

			document.getElementById('login-pagination-container').classList.add("d-none");
			isExpanded = false;
			document.getElementById("toggle-login-history").innerText = "Expand";
		}
	}

	function buildPagination() {
		const totalPages = Math.ceil(totalItems / perPage);
		const container = document.getElementById('login-pagination');
		container.innerHTML = '';

		for (let i = 1; i <= totalPages; i++) {
			const li = document.createElement('li');
			li.className = `page-item ${i === 1 ? 'active' : ''}`;
			li.innerHTML = `<a class="page-link" href="#" onclick="showPage(${i})">${i}</a>`;
			container.appendChild(li);
		}
	}

	function showPage(page) {
		currentPage = page;
		const start = (page - 1) * perPage;
		const end = start + perPage;

		items.forEach((el, idx) => {
			el.classList.toggle("d-none", !(idx >= start && idx < end));
		});

		// Update active page
		document.querySelectorAll('#login-pagination .page-item').forEach((el, idx) => {
			el.classList.toggle("active", idx === page - 1);
		});
	}
</script>




</html>